{% extends "base.html" %}
{% block content %}
<main>
    <section id="game-section">
            <h3>Game {{code}}</h3>
            <h3>Player {{player_name}}</h3>

        <div id="word-container">
            <h3 id="word">GUESS THE WORD</h3>
            <p id="trans"></p>
            <p id="timer">00:00</p>
            <button id="start-game" onClick="startGame()">START GAME</button>
            <button id="next-word" onClick="nextWord()">NEXT WORD</button>
        </div>

        <!--			<form id="guess-form">-->
        <!--				<label for="guess-input">Enter your guess:</label>-->
        <!--				<input type="text" id="guess-input" name="guess-input">-->
        <!--				<button type="submit" id="submit-btn">Submit</button>-->
        <!--			</form>-->
        <!--			<div id="scoreboard">-->
        <!--				<h3>Scoreboard</h3>-->
        <!--				<table>-->
        <!--					<thead>-->
        <!--						<tr>-->
        <!--							<th>Team</th>-->
        <!--							<th>Score</th>-->
        <!--						</tr>-->
        <!--					</thead>-->
        <!--					<tbody>-->
        <!--						<tr>-->
        <!--							<td>Team 1</td>-->
        <!--							<td>0</td>-->
        <!--						</tr>-->
        <!--						<tr>-->
        <!--							<td>Team 2</td>-->
        <!--							<td>0</td>-->
        <!--						</tr>-->
        <!--						&lt;!&ndash; Add additional rows for each team &ndash;&gt;-->
        <!--					</tbody>-->
        <!--				</table>-->
        <!--			</div>-->
    </section>
    <!-- Add any additional sections or elements here -->
</main>
<!-- Add any additional scripts or links here -->
<script type="text/javascript">
  var socketio = io();
  var timerSeconds = 0;
  var timerInterval;
  start_btn = document.getElementById("start-game");
  word_block = document.getElementById('word');
  next_word_btn = document.getElementById("next-word");
  trans_block = document.getElementById('trans');


  socketio.on("start", (data) => {
    console.log("response start game")
	  timerSeconds = data.timer;
	  start_btn.style.visibility = 'hidden';
    word_block.innerHTML = "GUESS THE WORD";
	  timerInterval = setInterval(updateTimer, 1000);
  });

  socketio.on("end", (data) => {
     console.log('response end game')
     timerElement.innerHTML = '00:00';
     next_word_btn.style.visibility = 'hidden';
     start_btn.style.visibility = 'visible';
     word_block.innerHTML = "READY FOR NEXT ROUND";
     trans_block.innerHTML = '';
  });

  socketio.on("next_word", (data) => {
    console.log('response next word')
    word_block.innerHTML = data.word;
    trans_block.innerHTML = data.trans;
  });

  socketio.on("word", (data) => {
    console.log('response word')
    word_block.innerHTML = data.word;
    trans_block.innerHTML = data.trans;
    next_word_btn.style.visibility = 'visible';
  });

  const startGame = () => {
    console.log('startGame')
	socketio.emit("startGame");
  };

  const endGame = () => {
    console.log('endGame')
	socketio.emit("endGame");
  };

  const nextWord = () => {
    console.log('nextWord')
	socketio.emit("nextWord");
  };

	// Get the timer element from the HTML
	const timerElement = document.getElementById('timer');

	// Function to update the timer
	function updateTimer() {
		// Decrement the number of seconds
		timerSeconds--;

        // Check if the timer has run out
        if (timerSeconds < 0) {
            // Stop the timer
            clearInterval(timerInterval);
            endGame();
        } else {
            // Update the timer display
            timerElement.innerHTML = timerSeconds;
        }
	}
</script>
{% endblock %}